## 分岔扩展设计总结（随机错误 + go_back 自纠）

- 目标：不改动原有步骤的 chosen。直接在“下一步”加入一条“看似合理但会跳转/破坏上下文”的错误动作作为分岔，并在“再下一步”用 `go_back()` 自我纠正；在 thought 中体现“状态对比 → 错因定位 → 回退决策”。

### 一、如何挑选更有挑战性的错误动作（保证会跳转）
- **导航类链接**：如 `link 'GUIDES'`（到 `/atlanta/guides`），保证 URL 改变，导致筛选上下文丢失。
- **地图/视图切换**：如 `button 'GO TO MAP'`，从列表切到地图，筛选布局改变。
- **站外/跨模块**：跳至其他模块（Reviews/Guides 等），让返回成为必要步骤。

推荐在相同页面的 `text_observation` 中检索可跳转的 `link` 元素，并选择与当前目标“相似但偏题”的项。

### 二、go_back 的思考模板（“三段式”）
- **状态对比**：点错后 URL/视图/结果数/筛选面板等客观信号发生变化。
- **错因定位**：顺序误判或上下文丢失（例如先跳转导致筛选未设置或被重置）。
- **回退决策**：回退可最快恢复到包含目标控件（如 “PERFECT FOR/评分/价位”）的页面。

示例（贴合 Infatuation）：
- “点击 ‘GUIDES’ 后 URL 从 /atlanta 跳到 /atlanta/guides，筛选面板不可见，说明偏离目标路径。为恢复到可继续设置筛选的页面，我需要回退。”

### 三、样例落地（task_id=1326）
- 保持第 3 步不变（原有 chosen 不修改）。
- 第 4 步：执行可跳转的分岔动作（例如 `click('1799')` → GUIDES）。
- 第 5 步：执行 `go_back()`，并在 thought 中写清“URL 改变 + 筛选上下文丢失 + 回退恢复”。
- 参考文件：`analysis/demos/branched_demo_1326.json`

### 四、实现要点
- ID 动态：不要依赖固定 ID 之外的页面结构；通过 `text_observation` 的可见链接文案确认动作语义（如 GUIDES）。
- 观测复用：跳转页面的观测可用 `simple_actree_capture.py` 或 `capture_actree.py` 抓取；我们已抓取 `/atlanta/guides` 并用于样例。
- 可扩展性：错误动作也可选 `GO TO MAP` 等，原理相同。

### 五、建议工作流
1) 在当前样本步骤的 `text_observation` 中检索“可跳转控件”（如链接/切图按钮），保持当前步骤不改动。
2) 在下一步使用“可跳转且有诱导性”的动作作为分岔（chosen）。
3) 再下一步执行 `go_back()`，按模板写 thought。
4) 可选：抓取跳转页 `text_observation`，记录到样例/扩展数据中。
